<p>var loanno = 1; var pipeline = new[] { // Match by Loanno new BsonDocument(&quot;$match&quot;, new BsonDocument(&quot;Loanno&quot;, loanno)), // Project to remove &apos;rules&apos; from Decision new BsonDocument(&quot;$project&quot;, new BsonDocument { { &quot;Loanno&quot;, 1 }, { &quot;result&quot;, new BsonDocument { { &quot;$map&quot;, new BsonDocument { { &quot;input&quot;, &quot;$result&quot; }, { &quot;as&quot;, &quot;item&quot; }, { &quot;in&quot;, new BsonDocument { { &quot;type&quot;, &quot;$$item.type&quot; }, { &quot;Decision&quot;, new BsonDocument { { &quot;Transaction&quot;, &quot;$$item.Decision.Transaction&quot; } // &quot;rules&quot; is omitted } } } } } } } } }) }; var result = collection.Aggregate(pipeline).ToList();&nbsp;</p>
<p><br></p>